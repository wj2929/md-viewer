# v1.1.0 回归测试清单

> **测试目的**: 确保 v1.1 新功能不影响 v1.0 核心功能
> **测试环境**: macOS / Windows / Linux
> **测试时间**: 预计 30-45 分钟
> **测试日期**: __________
> **测试人员**: __________

---

## 🚀 测试前准备

- [ ] 构建最新版本：`npm run build`
- [ ] 准备测试文件夹（包含 10+ 个 .md 文件，至少 1 个子文件夹）
- [ ] 准备包含以下特性的 Markdown 文件：
  - [ ] 标题、列表、表格
  - [ ] 代码块（JavaScript、Python、Bash）
  - [ ] 数学公式（行内 `$...$` 和块级 `$$...$$`）
  - [ ] Mermaid 图表（流程图、时序图）
  - [ ] 超过 10000 行的大文件

---

## ✅ 核心功能回归测试 (v1.0)

### 1. 应用启动
- [ ] 应用能正常启动
- [ ] 显示欢迎页面
- [ ] 标题栏显示 "MD Viewer"
- [ ] 窗口大小正常（最小 800x600）
- [ ] macOS 交通灯按钮位置正确

### 2. 文件夹操作
- [ ] 点击"打开文件夹"按钮 → 弹出系统对话框
- [ ] 选择文件夹后 → 文件树正确显示
- [ ] 文件夹名称在侧边栏顶部显示
- [ ] 点击"切换"按钮 → 可以切换到其他文件夹
- [ ] 重启应用 → 自动恢复上次打开的文件夹

### 3. 文件树显示
- [ ] 只显示 `.md` 文件（其他文件类型被过滤）
- [ ] 隐藏文件（以 `.` 开头）不显示
- [ ] `node_modules` 目录不显示
- [ ] 文件夹优先排序，然后按名称字母排序
- [ ] 子文件夹可以展开/折叠
- [ ] 递归显示所有子目录中的 .md 文件

### 4. 文件选择和标签页
- [ ] 点击文件 → 打开新标签页
- [ ] 标签页显示文件名
- [ ] 再次点击已打开的文件 → 切换到对应标签页（不重复打开）
- [ ] 可以同时打开多个标签页（测试打开 5 个文件）
- [ ] 点击标签 → 正确切换预览内容
- [ ] 点击标签的 × 按钮 → 正确关闭标签
- [ ] 关闭当前标签 → 自动切换到相邻标签
- [ ] 关闭最后一个标签 → 显示占位文本 "选择一个 Markdown 文件开始预览"
- [ ] 文件树中高亮显示当前活动标签对应的文件

### 5. Markdown 渲染
- [ ] **标题** (H1-H6) 正确渲染
- [ ] **粗体** (`**bold**`) 正确渲染
- [ ] **斜体** (`*italic*`) 正确渲染
- [ ] **删除线** (`~~strike~~`) 正确渲染
- [ ] **链接** 正确渲染（点击可打开浏览器）
- [ ] **图片** 正确渲染（支持相对路径和绝对路径）
- [ ] **列表** (有序、无序) 正确渲染
- [ ] **引用块** (`>`) 正确渲染
- [ ] **表格** 正确渲染并对齐
- [ ] **水平分隔线** (`---`) 正确渲染
- [ ] **行内代码** (`` `code` ``) 正确渲染

### 6. 代码高亮
- [ ] JavaScript 代码块高亮正确
- [ ] TypeScript 代码块高亮正确
- [ ] Python 代码块高亮正确
- [ ] Java 代码块高亮正确
- [ ] Go 代码块高亮正确
- [ ] Rust 代码块高亮正确
- [ ] Bash 代码块高亮正确
- [ ] JSON 代码块高亮正确
- [ ] YAML 代码块高亮正确
- [ ] 使用 VSCode Dark+ 主题
- [ ] 未知语言 → 显示为纯文本（不报错）

### 7. 数学公式 (KaTeX)
- [ ] 行内公式 `$E = mc^2$` 正确渲染
- [ ] 块级公式 `$$...$$` 正确渲染
- [ ] 复杂公式（分数、根号、求和）正确渲染
- [ ] 错误公式 → 显示错误提示（不崩溃）

### 8. 搜索功能
- [ ] **快捷键** ⌘K (macOS) / Ctrl+K (Windows/Linux) → 聚焦搜索框
- [ ] **文件名搜索**: 输入关键词 → 显示匹配的文件（最多 10 个）
- [ ] **模糊搜索**: 输入部分字符 → 也能匹配（例如 "tst" 匹配 "test.md"）
- [ ] 点击搜索结果 → 打开对应文件
- [ ] 点击空白处 → 关闭搜索结果
- [ ] **全文搜索**: 点击"全文搜索"按钮 → 搜索所有文件内容
- [ ] 全文搜索结果显示上下文（前后 40 字符）
- [ ] 搜索关键词高亮显示
- [ ] 点击全文搜索结果 → 打开对应文件
- [ ] 空搜索 → 不显示结果

### 9. 导出功能
- [ ] **导出 HTML**: 点击按钮 → 弹出保存对话框
- [ ] 保存 HTML 后 → 文件正确创建
- [ ] 打开导出的 HTML → 样式完整（包含 CSS）
- [ ] HTML 包含 KaTeX 公式
- [ ] HTML 包含代码高亮
- [ ] **导出 PDF**: 点击按钮 → 弹出保存对话框
- [ ] 保存 PDF 后 → 文件正确创建
- [ ] 打开导出的 PDF → 内容完整、排版正确
- [ ] PDF 包含数学公式
- [ ] PDF 包含代码高亮
- [ ] 没有打开标签时 → 导出按钮不显示

### 10. 性能和错误处理
- [ ] 打开 **大文件** (>10000 行) → 显示截断警告
- [ ] 截断警告显示总行数和显示行数
- [ ] 超大文件 (>5MB) → 显示错误提示（不崩溃）
- [ ] Markdown 渲染错误 → 降级显示原始内容（不白屏）
- [ ] 同时打开 10 个标签 → 应用不卡顿
- [ ] LRU 缓存工作正常（文件内容缓存最多 5 个）
- [ ] 内存占用合理（打开 10 个文件后 < 500MB）

### 11. 状态持久化
- [ ] 关闭应用 → 窗口大小和位置被记忆
- [ ] 重启应用 → 窗口恢复到上次的大小和位置
- [ ] 切换文件夹 → 最后打开的文件夹被记忆
- [ ] 重启应用 → 自动打开上次的文件夹

### 12. 主题适配
- [ ] 系统浅色主题 → 应用使用浅色样式
- [ ] 系统深色主题 → 应用使用深色样式
- [ ] 切换系统主题 → 应用自动适配（需要重启）
- [ ] Markdown 渲染区域主题正确
- [ ] 代码高亮主题适配深色模式

---

## 🆕 新功能测试 (v1.1)

### 13. Mermaid 图表支持
- [ ] **流程图** (`graph LR`) 正确渲染
- [ ] **时序图** (`sequenceDiagram`) 正确渲染
- [ ] **类图** (`classDiagram`) 正确渲染
- [ ] **状态图** (`stateDiagram`) 正确渲染
- [ ] **甘特图** (`gantt`) 正确渲染
- [ ] 明暗主题自适应（浅色主题用 default，深色主题用 dark）
- [ ] 错误的 Mermaid 语法 → 保留原始代码显示（不崩溃）
- [ ] 复杂图表（20+ 节点）正确渲染
- [ ] 图表可以正常缩放（SVG）

### 14. 文件监听自动刷新
- [ ] **文件修改**: 外部编辑器修改文件 → 2 秒内自动刷新标签页内容
- [ ] 多次快速修改 → 显示最新内容（不丢失更新）
- [ ] 修改未打开的文件 → 不影响性能
- [ ] **文件添加**: 添加新 .md 文件 → 文件树自动刷新
- [ ] 添加到子目录 → 子目录自动刷新
- [ ] 添加非 .md 文件 → 不影响文件树
- [ ] **文件删除**: 删除已打开的文件 → 标签自动关闭
- [ ] 删除已打开的文件 → 文件树自动刷新
- [ ] 删除未打开的文件 → 文件树自动刷新（标签不受影响）
- [ ] **文件重命名**: 重命名文件 → 等同于删除+添加（标签关闭，文件树更新）
- [ ] **子目录变化**: 监听递归到所有子目录
- [ ] 切换文件夹 → 停止旧文件夹监听，启动新文件夹监听
- [ ] 关闭应用 → 正确停止文件监听（不残留进程）

---

## 🔥 压力测试

### 15. 极端场景
- [ ] **大量文件**: 打开包含 100+ 个 .md 文件的文件夹 → 文件树正常加载
- [ ] **深层嵌套**: 文件夹嵌套 10 层 → 正常显示和监听
- [ ] **快速操作**: 快速连续打开/关闭 10 个标签 → 不崩溃
- [ ] **快速修改**: 1 秒内修改同一文件 5 次 → 显示最终结果
- [ ] **大量监听事件**: 同时修改 10 个文件 → 正确刷新所有打开的标签
- [ ] **特殊文件名**: 包含空格、中文、特殊符号的文件名 → 正常处理
- [ ] **损坏的 Markdown**: 包含未闭合标签、错误语法 → 不崩溃

---

## 📊 性能指标

| 指标 | 目标 | 实际 | 通过 |
|------|------|------|------|
| 应用启动时间 | < 2 秒 | _____ | ☐ |
| 文件夹加载时间 (100 文件) | < 3 秒 | _____ | ☐ |
| 文件打开时间 (< 1MB) | < 500ms | _____ | ☐ |
| 文件监听响应时间 | < 2 秒 | _____ | ☐ |
| 内存占用 (10 标签) | < 500MB | _____ | ☐ |
| CPU 占用 (空闲) | < 5% | _____ | ☐ |
| Mermaid 渲染时间 | < 1 秒 | _____ | ☐ |

---

## 🐛 发现的问题

| 序号 | 问题描述 | 严重性 | 复现步骤 | 状态 |
|------|----------|--------|----------|------|
| 1 | | P0/P1/P2 | | 待修复 |
| 2 | | P0/P1/P2 | | 待修复 |
| 3 | | P0/P1/P2 | | 待修复 |

**严重性定义**:
- **P0**: 阻塞发布（崩溃、数据丢失）
- **P1**: 核心功能不可用
- **P2**: 次要功能问题或体验问题

---

## ✅ 测试结论

- [ ] **全部通过** - 可以发布 v1.1.0
- [ ] **有 P0/P1 问题** - 必须修复后才能发布
- [ ] **仅有 P2 问题** - 可以发布，记录到 CHANGELOG 已知问题

**测试签名**: __________
**测试日期**: __________

---

**打印提示**: 使用 A4 纸双面打印，边测试边勾选 ✅

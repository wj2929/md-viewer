# MD Viewer 进度追踪

> Markdown 预览器项目进度状态
> **最后更新：2026-01-04 11:00** 🚀 **v1.3 阶段 0-3 完成**

---

## 📋 **当前状态：v1.3 开发中**

| 指标 | 状态 |
|------|------|
| **当前版本** | v1.2.0 ✅ **已发布** |
| **优化版本** | v1.2.1（快捷键 + E2E + 测试扩展）✅ |
| **开发版本** | v1.3.0 🚀 **阶段 0-3 完成** |
| **测试数量** | 355 个单元测试 (355 通过, 0 失败) ✅ |
| **测试覆盖率** | 58.46%（v1.3 目标：70% → 80%）|
| **安全状态** | ✅ 路径校验 + 沙箱 + 45 条保护规则 |
| **当前分支** | `feature/v1.3` |
| **下一步** | 阶段 4：优化虚拟滚动 |

---

## 🚀 **v1.3 开发进度（2026-01-04）**

### **阶段进度**

| 阶段 | 功能 | 状态 | 新增测试 | 提交 |
|------|------|------|----------|------|
| 阶段 0 | 安全加固 + 文件监听修复 | ✅ 完成 | +16 | `36450a9` |
| 阶段 1 | Tab 右键菜单 | ✅ 完成 | +15 | `ecd49d5` |
| 阶段 2 | Markdown 右键菜单 | ✅ 完成 | +12 | `9e79a07` |
| 阶段 3 | 重构剪贴板架构 | ✅ 完成 | - | `2e767f2` |
| 阶段 4 | 优化虚拟滚动 | ⏳ 待开发 | - | - |
| 阶段 5 | 多文件选择 | ⏳ 待开发 | - | - |
| 阶段 6 | 跨应用剪贴板 | ⏳ 待开发 | - | - |
| 阶段 7 | 测试覆盖率 70%+ | ⏳ 待开发 | - | - |

### **已完成功能详情**

#### 阶段 0：安全加固 + 文件监听增强 ✅
- ✅ PROTECTED_PATTERNS 扩展到 45+ 条规则
- ✅ 新增保护：Docker/Azure/GCloud/GitHub CLI 配置
- ✅ 新增保护：.env/.npmrc/.pypirc/.git-credentials
- ✅ 新增保护：SSH/证书私钥 (pem/p12/pfx/key/jks)
- ✅ 文件监听：新增 add/addDir/unlinkDir/rename 事件
- ✅ 500ms 时间窗口重命名检测机制

#### 阶段 1：Tab 右键菜单 ✅
- ✅ 菜单项：关闭、关闭其他、关闭所有
- ✅ 菜单项：关闭左侧、关闭右侧
- ✅ 菜单项：在 Finder 中显示、复制路径
- ✅ 菜单项根据 Tab 位置动态启用/禁用

#### 阶段 2：Markdown 右键菜单 ✅
- ✅ 菜单项：导出 HTML (Cmd+E)、导出 PDF (Cmd+Shift+E)
- ✅ 菜单项：复制为 Markdown、纯文本、HTML
- ✅ 有选中内容时显示"复制选中内容"
- ✅ 移除预览区顶部导出按钮

#### 阶段 3：重构剪贴板架构 ✅
- ✅ 渲染进程 clipboardStore 作为唯一数据源
- ✅ 主进程仅作为状态镜像
- ✅ 事务性粘贴：部分失败不丢失数据
- ✅ 右键菜单动态控制粘贴菜单启用状态

---

## 📊 **测试统计**

```
渲染进程测试：257/257 通过 ✅
主进程测试：  98/98  通过 ✅
─────────────────────────────────
总计：       355/355 通过 ✅
覆盖率：     58.46%（v1.3 目标：70%+）
```

---

## 📊 **Git 提交记录（v1.3 分支）**

```
2e767f2 feat(v1.3): 阶段 3 - 重构剪贴板架构（单一数据源）
9e79a07 feat(v1.3): 阶段 2 - Markdown 内容区右键菜单
ecd49d5 feat(v1.3): 阶段 1 - Tab 右键菜单
36450a9 feat(v1.3): 阶段 0 - 安全加固 + 文件监听增强
```

---

## 📋 **专家审批结果**

| 专家 | 结果 | 评分 |
|------|------|------|
| 架构师 | 有条件通过 | 7.5/10 |
| 前端专家 | 有条件通过 | 7.5/10 |
| 安全审计师 | 有条件通过 | 6.5/10 |
| 测试专家 | 有条件通过 | 6.5/10 |
| **综合** | **通过** | **7.0/10** |

---

## ✅ **v1.2.1 优化完成（2026-01-03 22:00）**

### 全局快捷键 ✅
- ✅ `⌘/Ctrl + O` - 打开文件夹
- ✅ `⌘/Ctrl + R` - 刷新文件树
- ✅ `⌘/Ctrl + W` - 关闭当前标签
- ✅ `⌘/Ctrl + E` - 导出 HTML
- ✅ `⌘/Ctrl + Shift + E` - 导出 PDF
- ✅ `⌘/Ctrl + F` - 聚焦搜索栏
- ✅ `⌘/Ctrl + Tab` - 下一个标签
- ✅ `⌘/Ctrl + Shift + Tab` - 上一个标签
- ✅ `⌘/Ctrl + 1-5` - 切换到指定标签

---

## ✅ **v1.2.0 发布（2026-01-03 21:36）**

| 阶段 | 内容 | 状态 |
|------|------|------|
| 阶段 0 | 安全加固（路径校验 + 沙箱）| ✅ |
| 阶段 1 | 右键菜单（Electron Menu）| ✅ |
| 阶段 2 | 应用内剪贴板（Zustand）| ✅ |
| 阶段 3 | 测试覆盖率提升 | ✅ |
| 阶段 4 | 虚拟滚动（react-virtuoso）| ✅ |
| 阶段 5 | 主题切换 UI（三档）| ✅ |

---

## 🚀 **功能总览**

| 功能 | 描述 | 版本 | 状态 |
|------|------|------|------|
| 安全加固 | 路径校验 + 沙箱 | v1.2.0 | ✅ |
| 右键菜单 | Electron 原生 Menu | v1.2.0 | ✅ |
| 应用内剪贴板 | Zustand 管理 | v1.2.0 | ✅ |
| 虚拟滚动 | react-virtuoso | v1.2.0 | ✅ |
| 主题切换 | 自动/亮/暗 | v1.2.0 | ✅ |
| 全局快捷键 | 10+ 快捷键 | v1.2.1 | ✅ |
| **安全加固** | 45+ 保护规则 | v1.3.0 | ✅ |
| **Tab 右键菜单** | 关闭当前/其他/所有 | v1.3.0 | ✅ |
| **Markdown 右键菜单** | 导出/复制 | v1.3.0 | ✅ |
| **剪贴板重构** | 单一数据源 | v1.3.0 | ✅ |
| 虚拟滚动优化 | CSS 调整 | v1.3.0 | ⏳ |
| 多文件选择 | Cmd+点击、Shift+点击 | v1.3.0 | ⏳ |
| 跨应用剪贴板 | Finder ↔ MD Viewer | v1.3.0 | ⏳ |

---

## 📊 **版本规划**

| 版本 | 核心功能 | 状态 |
|------|----------|------|
| v1.0 | 纯预览器 | ✅ 完成 |
| v1.1 | Mermaid + 文件监听 | ✅ 完成 |
| v1.1.1 | Bug修复 | ✅ 完成 |
| v1.1.2 | KaTeX/Mermaid 修复 | ✅ 完成 |
| v1.2.0 | 安全 + 右键 + 剪贴板 + 虚拟滚动 + 主题 | ✅ 已发布 |
| v1.2.1 | 快捷键 + E2E + 测试扩展 | ✅ 完成 |
| **v1.3.0** | **Tab菜单 + Markdown菜单 + 多选 + 跨应用剪贴板** | 🚀 **阶段 0-3 完成** |
| v1.4 | 拖拽操作 + 性能优化 | 未开始 |
| v2.0 | 插件系统 | 未开始 |

---

## 📅 **变更历史**

| 日期 | 时间 | 变更内容 |
|------|------|----------|
| 2026-01-02 | 14:00 | 项目初始化 |
| 2026-01-02 | 23:00 | v1.0.0 发布 |
| 2026-01-03 | 07:00 | v1.1.0 发布 |
| 2026-01-03 | 17:00 | v1.1.1 发布 |
| 2026-01-03 | 18:30 | v1.1.2 发布 |
| 2026-01-03 | 21:36 | v1.2.0 发布 ✅ |
| 2026-01-03 | 22:00 | v1.2.1 优化完成 ✅ |
| 2026-01-04 | 10:00 | v1.3 规划完成，4 位专家审批通过 📋 |
| **2026-01-04** | **11:00** | **v1.3 阶段 0-3 完成 🚀** |

---

**更新频率**：实时更新
**维护者**：wj2929
**当前状态**：🚀 **v1.3 开发中（阶段 0-3 完成，355 测试通过）**
